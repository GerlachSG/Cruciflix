<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Área Kids - Cruciflix - Conteúdo seguro para crianças">
    <title>Kids - Cruciflix</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@600;700;800&display=swap"
        rel="stylesheet">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/responsive.css">

    <style>
        /* Kids Area Specific Styles */
        .kids-page {
            padding-top: 70px;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e 0%, #2a2a4e 100%);
        }

        .kids-header {
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
            padding: var(--spacing-3xl);
            text-align: center;
            margin-bottom: var(--spacing-2xl);
        }

        .kids-title {
            font-size: var(--font-size-4xl);
            color: white;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
            margin-bottom: var(--spacing-md);
        }

        .kids-subtitle {
            font-size: var(--font-size-xl);
            color: rgba(255, 255, 255, 0.9);
        }

        .kids-emoji {
            font-size: 4rem;
            margin-bottom: var(--spacing-md);
        }

        .kids-back-btn {
            position: fixed;
            top: 80px;
            left: var(--spacing-lg);
            z-index: 10;
        }

        .kids-video-card {
            background: var(--color-bg-card);
            border-radius: var(--radius-xl);
            overflow: hidden;
            cursor: pointer;
            transition: all var(--transition-normal);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            border: 3px solid transparent;
        }

        .kids-video-card:hover {
            transform: scale(1.05);
            border-color: var(--color-secondary);
            box-shadow: 0 8px 16px rgba(212, 175, 55, 0.4);
        }

        .kids-videos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--spacing-2xl);
            padding: var(--spacing-xl);
        }
    </style>
</head>

<body>

    <!-- Header Navigation -->
    <header class="main-header">
        <div class="container">
            <nav class="nav-container">
                <div class="logo">Cruci<span class="accent">flix</span> <span style="font-size: 0.7em;">Kids</span>
                </div>

                <div class="user-menu">
                    <div class="user-menu-btn" id="user-menu-btn">
                        <div class="user-avatar" id="user-avatar">K</div>
                    </div>
                    <div class="user-menu-dropdown" id="user-menu-dropdown">
                        <a href="dashboard.html">Voltar ao Catálogo Principal</a>
                        <a href="profile.html">Meu Perfil</a>
                        <a href="#" onclick="handleLogout(event)">Sair</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="kids-page">

        <button class="btn btn-secondary kids-back-btn" onclick="window.location.href='dashboard.html'">
            ← Voltar
        </button>

        <div class="kids-header">

            <h1 class="kids-title">Área Kids</h1>
            <p class="kids-subtitle">Conteúdo seguro e educativo para crianças</p>
        </div>

        <div class="container">
            <div class="kids-videos-grid" id="kids-videos-container">
                <!-- Kids videos loaded dynamically -->
            </div>
        </div>

    </main>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>

    <!-- App Scripts -->
    <script src="../scripts/firebase-config.js"></script>
    <script src="../scripts/auth.js"></script>
    <script src="../scripts/firestore.js"></script>
    <script src="../scripts/ui.js"></script>

    <script>
        // Protect page - require authentication
        window.authModule.onAuthStateChanged(async (authState) => {
            if (!authState.loggedIn) {
                window.location.href = 'index.html';
                return;
            }

            // Update user avatar
            const user = authState.user;
            const initials = user.displayName ? user.displayName.charAt(0).toUpperCase() : user.email.charAt(0).toUpperCase();
            document.getElementById('user-avatar').textContent = initials;

            // Load kids videos
            loadKidsVideos();
        });

        // Load kids-safe videos
        async function loadKidsVideos() {
            window.uiModule.showLoading();

            const videos = await window.firestoreModule.getKidsVideos();

            const container = document.getElementById('kids-videos-container');
            container.innerHTML = '';

            if (videos.length === 0) {
                container.innerHTML = '<p class="no-results">Nenhum vídeo infantil disponível no momento.</p>';
                window.uiModule.hideLoading();
                return;
            }

            videos.forEach(video => {
                const card = createKidsVideoCard(video);
                container.appendChild(card);
            });

            window.uiModule.hideLoading();
        }

        // Create kids video card (larger, more colorful)
        function createKidsVideoCard(video) {
            const card = document.createElement('div');
            card.className = 'kids-video-card';
            card.onclick = () => window.location.href = `player.html?v=${video.id}`;

            const thumbnail = video.thumbnailUrl || 'https://via.placeholder.com/400x225/8b0000/ffd700?text=' + encodeURIComponent(video.title);

            card.innerHTML = `
      <div class="video-thumbnail" style="background-image: url('${thumbnail}'); height: 180px;">
        <div class="play-overlay">
          <svg width="80" height="80" viewBox="0 0 24 24" fill="white">
            <path d="M8 5v14l11-7z"/>
          </svg>
        </div>
      </div>
      <div class="video-info" style="padding: var(--spacing-lg);">
        <h3 class="video-title" style="font-size: var(--font-size-xl); white-space: normal;">${video.title}</h3>
        <p class="video-description" style="font-size: var(--font-size-md);">${window.uiModule.truncate(video.description, 80)}</p>
      </div>
    `;

            return card;
        }

        // Handle logout
        async function handleLogout(event) {
            event.preventDefault();
            const result = await window.authModule.logoutUser();
            if (result.success) {
                window.location.href = 'index.html';
            }
        }
    </script>

</body>

</html>