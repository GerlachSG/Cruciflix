<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Catálogo Cruciflix - Explore nosso acervo de filmes, séries e documentários católicos">
    <title>Catálogo - Cruciflix</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@600;700;800&display=swap"
        rel="stylesheet">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/responsive.css">

    <style>
        /* Dashboard Specific Styles */
        .dashboard-page {
            padding-top: 70px;
            min-height: 100vh;
        }

        .hero-section {
            height: 500px;
            background: linear-gradient(to bottom, transparent 0%, var(--color-bg-dark) 100%),
                url('https://images.unsplash.com/photo-1488998427799-e3362cec87c3?q=80&w=2340') center/cover;
            display: flex;
            align-items: flex-end;
            padding: var(--spacing-3xl);
            margin-bottom: var(--spacing-3xl);
            position: relative;
        }

        .hero-content {
            max-width: 600px;
            z-index: 1;
        }

        .hero-title {
            font-size: var(--font-size-4xl);
            margin-bottom: var(--spacing-md);
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8);
        }

        .hero-description {
            font-size: var(--font-size-lg);
            color: var(--color-text-secondary);
            margin-bottom: var(--spacing-xl);
            line-height: 1.6;
            text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.8);
        }

        .hero-actions {
            display: flex;
            gap: var(--spacing-md);
        }

        .filter-section {
            background: var(--color-bg-card);
            padding: var(--spacing-xl);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-xl);
        }

        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }

        .tag-filters {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }

        .tag-filter {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            background: rgba(139, 0, 0, 0.2);
            border: 1px solid rgba(139, 0, 0, 0.4);
            border-radius: var(--radius-full);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .tag-filter:has(input:checked) {
            background: var(--color-primary);
            border-color: var(--color-primary);
        }

        .tag-filter input[type="checkbox"] {
            margin: 0;
            cursor: pointer;
        }

        .tag-filter label {
            cursor: pointer;
            margin: 0;
            font-weight: 500;
            font-size: var(--font-size-sm);
        }

        .videos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-3xl);
        }
    </style>
</head>

<body>

    <!-- Header Navigation -->
    <header class="main-header">
        <div class="container">
            <nav class="nav-container">
                <div class="logo">Cruci<span class="accent">flix</span></div>

                <button class="mobile-menu-toggle" id="mobile-menu-toggle">☰</button>

                <div class="main-nav">
                    <ul>
                        <li><a href="dashboard.html">Início</a></li>
                        <li><a href="kids.html">Kids</a></li>
                        <li><a href="#" onclick="filterByTag('Filme')">Filmes</a></li>
                        <li><a href="#" onclick="filterByTag('Série')">Séries</a></li>
                        <li><a href="#" onclick="filterByTag('Formação')">Formação</a></li>
                    </ul>
                </div>

                <div class="search-bar">
                    <input type="text" id="search-input" placeholder="Buscar conteúdo...">
                </div>

                <div class="user-menu">
                    <div class="user-menu-btn" id="user-menu-btn">
                        <div class="user-avatar" id="user-avatar">U</div>
                        <span id="user-name">Usuário</span>
                    </div>
                    <div class="user-menu-dropdown" id="user-menu-dropdown">
                        <a href="profile.html">Meu Perfil</a>
                        <a href="#" id="admin-link" style="display:none;">Painel Admin</a>
                        <a href="#" onclick="handleLogout(event)">Sair</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="dashboard-page">

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">Bem-vindo ao Cruciflix</h1>
                <p class="hero-description">
                    Assista aos melhores filmes, séries e documentários católicos. Fortaleça sua fé enquanto se
                    entretém.
                </p>
                <div class="hero-actions">
                    <button class="btn btn-primary" onclick="scrollToContent()">Explorar Catálogo</button>
                    <button class="btn btn-secondary" onclick="window.location.href='kids.html'">Área Kids</button>
                </div>
            </div>
        </section>

        <div class="container">

            <!-- Filter Section -->
            <section class="filter-section" id="filter-section">
                <div class="filter-header">
                    <h2>Filtrar por Tags</h2>
                    <button class="btn btn-ghost btn-sm" onclick="window.uiModule.resetFilters()">Limpar
                        Filtros</button>
                </div>

                <div class="tag-filters" id="tag-filters">
                    <div class="tag-filter">
                        <input type="checkbox" id="tag-filme" value="Filme">
                        <label for="tag-filme">Filmes</label>
                    </div>
                    <div class="tag-filter">
                        <input type="checkbox" id="tag-serie" value="Série">
                        <label for="tag-serie">Séries</label>
                    </div>
                    <div class="tag-filter">
                        <input type="checkbox" id="tag-documentario" value="Documentário">
                        <label for="tag-documentario">Documentários</label>
                    </div>
                    <div class="tag-filter">
                        <input type="checkbox" id="tag-formacao" value="Formação">
                        <label for="tag-formacao">Formação</label>
                    </div>
                    <div class="tag-filter">
                        <input type="checkbox" id="tag-medieval" value="Medieval">
                        <label for="tag-medieval">Medieval</label>
                    </div>
                    <div class="tag-filter">
                        <input type="checkbox" id="tag-santo" value="Santo">
                        <label for="tag-santo">Santos</label>
                    </div>
                    <div class="tag-filter">
                        <input type="checkbox" id="tag-biblia" value="Bíblia">
                        <label for="tag-biblia">Bíblia</label>
                    </div>
                    <div class="tag-filter">
                        <input type="checkbox" id="tag-catecismo" value="Catecismo">
                        <label for="tag-catecismo">Catecismo</label>
                    </div>
                </div>
            </section>

            <!-- Videos Section -->
            <section>
                <h2 class="section-title">Conteúdo Disponível</h2>
                <div class="videos-grid" id="videos-container">
                    <!-- Videos will be loaded dynamically -->
                </div>
            </section>

        </div>
    </main>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>

    <!-- App Scripts -->
    <script src="../scripts/firebase-config.js"></script>
    <script src="../scripts/auth.js"></script>
    <script src="../scripts/firestore.js"></script>
    <script src="../scripts/ui.js"></script>

    <script>
        // Protect page - require authentication
        window.authModule.onAuthStateChanged(async (authState) => {
            if (!authState.loggedIn) {
                window.location.href = 'index.html';
                return;
            }

            // Update user info in header
            const user = authState.user;
            document.getElementById('user-name').textContent = user.displayName || user.email;
            const initials = user.displayName ? user.displayName.charAt(0).toUpperCase() : user.email.charAt(0).toUpperCase();
            document.getElementById('user-avatar').textContent = initials;

            // Show admin link if user is admin
            if (authState.isAdmin) {
                document.getElementById('admin-link').style.display = 'block';
                document.getElementById('admin-link').href = 'admin.html';
            }

            // Load videos
            loadAllVideos();
        });

        // Load all videos
        async function loadAllVideos() {
            window.uiModule.showLoading();
            const videos = await window.firestoreModule.getAllVideos();
            window.uiModule.displayVideos(videos);
            window.uiModule.hideLoading();
        }

        // Setup tag filters
        const tagCheckboxes = document.querySelectorAll('.tag-filter input[type="checkbox"]');
        window.uiModule.setupTagFilter(tagCheckboxes);

        // Setup search
        const searchInput = document.getElementById('search-input');
        window.uiModule.setupSearch(searchInput);

        // Filter by specific tag (from navigation)
        function filterByTag(tag) {
            scrollToContent();

            // Clear all filters first
            tagCheckboxes.forEach(cb => cb.checked = false);

            // Check the specific tag
            const checkbox = document.querySelector(`input[value="${tag}"]`);
            if (checkbox) {
                checkbox.checked = true;
                checkbox.dispatchEvent(new Event('change'));
            }
        }

        // Scroll to content
        function scrollToContent() {
            document.getElementById('filter-section').scrollIntoView({ behavior: 'smooth' });
        }

        // Handle logout
        async function handleLogout(event) {
            event.preventDefault();

            const result = await window.authModule.logoutUser();

            if (result.success) {
                window.location.href = 'index.html';
            } else {
                window.uiModule.showToast('Erro ao sair', 'error');
            }
        }
    </script>

</body>

</html>